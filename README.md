This repository contains the code needed to reproduce all results and plots in the paper " Single-cell sequencing analysis and machine learning model reveal aberrant TIM3 expression in microglia during Alzheimer's disease progression ", Xu Z.T. et al. Code snippets are separated into files mirroring the organization of figures in the manuscript.

scRNA_project(1): This scRNA-seq pipeline uses Seurat for core analysis, harmony for batch correction, and SingleR for cell annotation. Quality control employs ggplot2 to generate violin plots (nFeature_RNA, percent_mito) and feature scatterplots. Clustering resolution was selected using clustree dendrograms, with results visualized through UMAP projections. Marker genes were identified via COSG and displayed in heatmaps, while cell proportions were analyzed using balloon plots and stacked bar charts. The study specifically characterizes TIM3+ microglia (HAVCR2+) through FeaturePlot overlays on UMAPs and differential expression analysis, with results visualized in volcano plots. Functional enrichment used clusterProfiler for pathway analysis. The workflow systematically combines these tools to profile neuronal/glial populations, with particular focus on TIM3+ microglia's transcriptional signature.

scRNA_project(2): This scRNA-seq analysis script builds upon Seurat's core functionality to perform specialized characterization of TIM3+ microglia, leveraging multiple R packages for enhanced visualization and downstream analysis. The pipeline employs ggplot2 and patchwork for creating publication-quality plots, including a cell type distribution bar chart and UMAP projections that use a customized 20-color palette for consistent cell type representation. The analysis prepares for trajectory inference through slingshot and monocle3, while CellChat is loaded for planned cell-cell communication studies. Additional visualization tools like ComplexHeatmap and pheatmap are incorporated for advanced plotting, with viridis providing color scales. The script maintains standardized formatting across all outputs with properly labeled axes, titles (using theme_minimal()), and legend placement. Functional analysis capabilities are enabled through clusterProfiler with human gene annotations (org.Hs.eg.db). 

scripts.R: This machine learning pipeline integrates 12 algorithms (including Lasso, RandomForest, XGBoost) through 113 combinatorial models for biomarker discovery, utilizing glmnet, xgboost and caret packages for core modeling. The workflow processes expression matrices (Training_expr.txt) with binary classifications (Training_class.txt), performing cohort-aware scaling before feature selection with randomForestSRC and variable importance ranking via gbm. Model evaluation leverages pROC for AUC calculations across validation cohorts, visualized through ComplexHeatmap showing algorithm performance comparisons. Key predictive features are extracted from top-performing models and displayed in publication-ready ggplot2 barplots, highlighting the most influential genes. The pipeline implements snowfall for parallelization when handling multiple algorithm combinations, while RColorBrewer ensures consistent visual styling. Outputs include trained models (model.rds), prediction matrices (RS_mat.txt) and a distilled gene list from the optimal model.
